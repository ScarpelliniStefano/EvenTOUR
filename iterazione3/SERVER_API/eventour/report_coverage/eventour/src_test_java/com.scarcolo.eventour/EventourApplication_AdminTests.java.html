<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="it"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../../jacoco-resources/report.gif" type="image/gif"/><title>EventourApplication_AdminTests.java</title><link rel="stylesheet" href="../../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../../index.html" class="el_report">com.scarcolo.eventour (30 dic 2021 11:11:30)</a> &gt; <a href="../../index.html" class="el_group">eventour</a> &gt; <a href="../index.html" class="el_bundle">src/test/java</a> &gt; <a href="index.source.html" class="el_package">com.scarcolo.eventour</a> &gt; <span class="el_source">EventourApplication_AdminTests.java</span></div><h1>EventourApplication_AdminTests.java</h1><pre class="source lang-java linenums">package com.scarcolo.eventour;



import org.json.JSONArray;
import org.json.JSONObject;
import org.junit.jupiter.api.Test;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.boot.test.context.SpringBootTest.WebEnvironment;
import org.springframework.boot.test.web.client.TestRestTemplate;
import org.springframework.boot.web.server.LocalServerPort;
import org.springframework.http.HttpEntity;
import org.springframework.http.HttpMethod;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;

import com.scarcolo.eventour.functions.Functionalities;
import com.scarcolo.eventour.model.Location;
import com.scarcolo.eventour.model.admin.AddAdminRequest;
import com.scarcolo.eventour.model.admin.AdminResponse;
import com.scarcolo.eventour.model.admin.EditAdminRequest;
import com.scarcolo.eventour.model.manager.AddManagerRequest;
import com.scarcolo.eventour.model.manager.EditManagerRequest;
import com.scarcolo.eventour.model.manager.ManagerResponse;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertTrue;

import java.text.SimpleDateFormat;
import java.time.LocalDate;
import java.time.LocalDateTime;
import java.util.Date;

@SpringBootTest(webEnvironment = WebEnvironment.RANDOM_PORT)
<span class="fc" id="L37">class EventourApplication_AdminTests {</span>
	@LocalServerPort
	private int port;

	@Autowired
	private TestRestTemplate restTemplate;
	
	@Test
	public void newAdmin() throws Exception {
<span class="fc" id="L46">		AddAdminRequest request=new AddAdminRequest();</span>
<span class="fc" id="L47">		request.name=&quot;utenteNomeProva&quot;;</span>
<span class="fc" id="L48">		request.surname=&quot;utenteCognomeProva&quot;;</span>
<span class="fc" id="L49">		request.mail=&quot;provaAdmin@gmail.com&quot;;</span>
<span class="fc" id="L50">		request.password=&quot;provaUser&quot;;</span>
<span class="fc" id="L51">		request.role=&quot;helper&quot;;</span>
<span class="fc" id="L52">		AdminResponse adminCreated = restTemplate.postForObject(&quot;http://localhost:&quot; + port + &quot;/api/admins&quot;, request, AdminResponse.class);</span>
<span class="fc" id="L53">		assertEquals(adminCreated.getMail(), &quot;provaAdmin@gmail.com&quot;);</span>
		
<span class="fc" id="L55">		String reqDel=&quot;http://localhost:&quot; + port + &quot;/api/admins/&quot;+adminCreated.getId();</span>
<span class="fc" id="L56">		restTemplate.delete(reqDel);</span>
		

<span class="fc" id="L59">	}</span>
	
	@Test
	public void updateAdmin() throws Exception {
<span class="fc" id="L63">		AddAdminRequest request=new AddAdminRequest();</span>
<span class="fc" id="L64">		request.name=&quot;utenteNomeProva&quot;;</span>
<span class="fc" id="L65">		request.surname=&quot;utenteCognomeProva&quot;;</span>
<span class="fc" id="L66">		request.mail=&quot;provaAdmin@gmail.com&quot;;</span>
<span class="fc" id="L67">		request.password=&quot;provaUser&quot;;</span>
<span class="fc" id="L68">		request.role=&quot;helper&quot;;</span>
<span class="fc" id="L69">		AdminResponse adminCreated = restTemplate.postForObject(&quot;http://localhost:&quot; + port + &quot;/api/admins&quot;, request, AdminResponse.class);</span>
<span class="fc" id="L70">		EditAdminRequest reqUpd=new EditAdminRequest();</span>
<span class="fc" id="L71">		reqUpd.id=adminCreated.getId();</span>
<span class="fc" id="L72">		reqUpd.role=&quot;moderator&quot;;</span>
<span class="fc" id="L73">		ResponseEntity&lt;AdminResponse&gt; resp=restTemplate.exchange(&quot;http://localhost:&quot; + port + &quot;/api/admins&quot;, HttpMethod.PUT, new HttpEntity&lt;EditAdminRequest&gt;(reqUpd), AdminResponse.class);</span>
<span class="fc" id="L74">		assertEquals(resp.getStatusCodeValue(),200);</span>
<span class="fc" id="L75">		assertEquals(resp.getBody().getMail(),&quot;provaAdmin@gmail.com&quot;);</span>
<span class="fc" id="L76">		assertEquals(resp.getBody().getRole(),&quot;MODERATOR&quot;);</span>
<span class="fc" id="L77">		String reqDel=&quot;http://localhost:&quot; + port + &quot;/api/admins/&quot;+adminCreated.getId();</span>
<span class="fc" id="L78">		restTemplate.delete(reqDel);</span>
		
<span class="fc" id="L80">	}</span>
	
	@Test
	public void deleteAdmin() throws Exception {
<span class="fc" id="L84">		AddAdminRequest request=new AddAdminRequest();</span>
<span class="fc" id="L85">		request.name=&quot;utenteNomeProva&quot;;</span>
<span class="fc" id="L86">		request.surname=&quot;utenteCognomeProva&quot;;</span>
<span class="fc" id="L87">		request.mail=&quot;provaAdmin@gmail.com&quot;;</span>
<span class="fc" id="L88">		request.password=&quot;provaUser&quot;;</span>
<span class="fc" id="L89">		request.role=&quot;helper&quot;;</span>
<span class="fc" id="L90">		AdminResponse adminCreated = restTemplate.postForObject(&quot;http://localhost:&quot; + port + &quot;/api/admins&quot;, request, AdminResponse.class);</span>
<span class="fc" id="L91">		String delMan=&quot;http://localhost:&quot; + port + &quot;/api/admins/&quot;+adminCreated.getId();</span>
<span class="fc" id="L92">		ResponseEntity&lt;Boolean&gt; resp=restTemplate.exchange(delMan, HttpMethod.DELETE, null, Boolean.class);</span>
<span class="fc" id="L93">		assertEquals(resp.getBody(),true);</span>
		
<span class="fc" id="L95">	}</span>
	
	@Test
	public void deleteAdminNonCorrect() throws Exception {
<span class="fc" id="L99">		ResponseEntity&lt;Boolean&gt; resp=restTemplate.exchange(&quot;http://localhost:&quot; + port + &quot;/api/admins/618a43a5885c9f6aab4af98a&quot;, HttpMethod.DELETE, null, Boolean.class);</span>
<span class="fc" id="L100">		assertEquals(resp.getStatusCode(),HttpStatus.BAD_REQUEST);</span>
<span class="fc" id="L101">	}</span>


	@Test
	public void getAdminById() throws Exception {
<span class="fc" id="L106">		String request=this.restTemplate.getForObject(&quot;http://localhost:&quot; + port + &quot;/api/admins/id=618a43a5885c9f6aab4af98b&quot;,</span>
<span class="fc" id="L107">				String.class);</span>
<span class="fc" id="L108">		JSONObject obj = new JSONObject(request);</span>
<span class="fc" id="L109">		String stringId = obj.getString(&quot;id&quot;);</span>
<span class="fc" id="L110">		assertEquals(stringId,&quot;618a43a5885c9f6aab4af98b&quot;);</span>
<span class="fc" id="L111">		assertEquals(obj.getString(&quot;mail&quot;),&quot;admin@gmail.com&quot;);</span>
<span class="fc" id="L112">		assertEquals(obj.getString(&quot;name&quot;),&quot;Administrator&quot;);</span>
<span class="fc" id="L113">	}</span>
	
	@Test
	public void getAdminByIdError() throws Exception {
<span class="fc" id="L117">		ResponseEntity&lt;String&gt; request=this.restTemplate.getForEntity(&quot;http://localhost:&quot; + port + &quot;/api/admins/id=618a43a5885c9f6aab4af98a&quot;,</span>
<span class="fc" id="L118">				String.class);</span>
<span class="fc" id="L119">		int statusCode=request.getStatusCodeValue();</span>
<span class="fc" id="L120">		assertEquals(statusCode,404);</span>
		
<span class="fc" id="L122">	}</span>
	
	@Test
	public void getAdminReport() throws Exception {
<span class="fc" id="L126">		ResponseEntity&lt;String&gt; request=this.restTemplate.getForEntity(&quot;http://localhost:&quot; + port + &quot;/api/admins/reports&quot;,</span>
<span class="fc" id="L127">				String.class);</span>
<span class="fc" id="L128">		assertEquals(request.getStatusCode(),HttpStatus.OK);</span>
<span class="fc" id="L129">	}</span>
	
	@Test
	public void getAdminAll() throws Exception {
<span class="fc" id="L133">		ResponseEntity&lt;String&gt; request=this.restTemplate.getForEntity(&quot;http://localhost:&quot; + port + &quot;/api/admins/&quot;,</span>
<span class="fc" id="L134">				String.class);</span>
<span class="fc" id="L135">		assertEquals(request.getStatusCode(),HttpStatus.OK);</span>
<span class="fc" id="L136">		JSONArray reqArr=new JSONArray(request.getBody());</span>
<span class="fc" id="L137">		assertEquals(reqArr.length(),2);</span>
<span class="fc" id="L138">	}</span>
	
	@Test
	public void getAdminMail() throws Exception {
<span class="fc" id="L142">		ResponseEntity&lt;AdminResponse&gt; request=this.restTemplate.getForEntity(&quot;http://localhost:&quot; + port + &quot;/api/admins/admin@gmail.com&quot;,</span>
<span class="fc" id="L143">				AdminResponse.class);</span>
<span class="fc" id="L144">		assertEquals(request.getStatusCode(),HttpStatus.OK);</span>
<span class="fc" id="L145">		assertEquals(request.getBody().getId(),&quot;618a43a5885c9f6aab4af98b&quot;);</span>
<span class="fc" id="L146">	}</span>
	
	@Test
	public void getAdminMailNonPresent() throws Exception {
<span class="fc" id="L150">		ResponseEntity&lt;AdminResponse&gt; request=this.restTemplate.getForEntity(&quot;http://localhost:&quot; + port + &quot;/api/admins/adminNonPres@gmail.com&quot;,</span>
<span class="fc" id="L151">				AdminResponse.class);</span>
<span class="fc" id="L152">		assertEquals(request.getStatusCode(),HttpStatus.NOT_FOUND);</span>
<span class="fc" id="L153">	}</span>
	
	@Test
	public void getAdminMailError() throws Exception {
<span class="fc" id="L157">		ResponseEntity&lt;AdminResponse&gt; request=this.restTemplate.getForEntity(&quot;http://localhost:&quot; + port + &quot;/api/admins/admingmail.com&quot;,</span>
<span class="fc" id="L158">				AdminResponse.class);</span>
<span class="fc" id="L159">		assertEquals(request.getStatusCode(),HttpStatus.BAD_REQUEST);</span>
<span class="fc" id="L160">	}</span>
	
	@Test
	public void getAdminNewsletter() throws Exception {
<span class="fc" id="L164">		ResponseEntity&lt;String&gt; request=this.restTemplate.getForEntity(&quot;http://localhost:&quot; + port + &quot;/api/admins/newsletter&quot;,</span>
<span class="fc" id="L165">				String.class);</span>
<span class="fc" id="L166">		assertEquals(request.getStatusCode(),HttpStatus.OK);</span>
<span class="fc" id="L167">	}</span>
	
	@Test
	public void getAdminRequests() throws Exception {
<span class="fc" id="L171">		ResponseEntity&lt;String&gt; request=this.restTemplate.getForEntity(&quot;http://localhost:&quot; + port + &quot;/api/admins/requests&quot;,</span>
<span class="fc" id="L172">				String.class);</span>
<span class="fc" id="L173">		assertEquals(request.getStatusCode(),HttpStatus.OK);</span>
<span class="fc" id="L174">		JSONArray arr=new JSONArray(request.getBody());</span>
<span class="fc bfc" id="L175" title="All 2 branches covered.">		for(int i=0;i&lt;arr.length();i++) {</span>
<span class="fc" id="L176">			assertEquals(arr.getJSONObject(i).getBoolean(&quot;active&quot;),false);</span>
		}
<span class="fc" id="L178">	}</span>
	
	@Test
	public void getAdminAccept() throws Exception {
<span class="fc" id="L182">		AddManagerRequest request=new AddManagerRequest();</span>
<span class="fc" id="L183">		request.name=&quot;utenteNomeProva&quot;;</span>
<span class="fc" id="L184">		request.surname=&quot;utenteCognomeProva&quot;;</span>
<span class="fc" id="L185">		request.mail=&quot;prova@gmail.com&quot;;</span>
<span class="fc" id="L186">		request.password=&quot;provaUser&quot;;</span>
<span class="fc" id="L187">		request.dateOfBirth=LocalDate.now().minusYears(30);</span>
<span class="fc" id="L188">		request.residence=new Location();</span>
<span class="fc" id="L189">				request.residence.setLocality(&quot;prova via&quot;);</span>
<span class="fc" id="L190">				request.residence.setCap(&quot;24042&quot;);</span>
<span class="fc" id="L191">				request.residence.setRegione(&quot;Lombardia&quot;);</span>
<span class="fc" id="L192">				request.residence.setProvincia(&quot;Bergamo&quot;);</span>
<span class="fc" id="L193">				request.residence.setCity(&quot;Albino&quot;);</span>
<span class="fc" id="L194">				request.residence.setLat(44d);</span>
<span class="fc" id="L195">				request.residence.setLng(9d);</span>
<span class="fc" id="L196">				request.residence.setSigla(&quot;BG&quot;);</span>
<span class="fc" id="L197">		request.codicePIVA=&quot;77914680192&quot;;</span>
<span class="fc" id="L198">		request.ragioneSociale=&quot;prova s.r.l.&quot;;</span>
<span class="fc" id="L199">		ManagerResponse managerCreated = restTemplate.postForObject(&quot;http://localhost:&quot; + port + &quot;/api/managers&quot;, request, ManagerResponse.class);</span>
<span class="fc" id="L200">		ResponseEntity&lt;String&gt; requestNonActive=this.restTemplate.getForEntity(&quot;http://localhost:&quot; + port + &quot;/api/admins/requests&quot;,</span>
<span class="fc" id="L201">				String.class);</span>
<span class="fc" id="L202">		JSONArray arr=new JSONArray(requestNonActive.getBody());</span>
<span class="fc" id="L203">		Boolean finded=false;</span>
		
<span class="pc bpc" id="L205" title="1 of 4 branches missed.">		for(int i=0;i&lt;arr.length() &amp;&amp; finded==false;i++) {</span>
<span class="pc bpc" id="L206" title="1 of 2 branches missed.">			if(arr.getJSONObject(i).getString(&quot;id&quot;).contentEquals(managerCreated.getId())) finded=true;</span>
		}
<span class="fc" id="L208">		assertEquals(finded,true);</span>
<span class="fc" id="L209">		ResponseEntity&lt;Boolean&gt; requestAccept=this.restTemplate.getForEntity(&quot;http://localhost:&quot; + port + &quot;/api/admins/accept/&quot;+managerCreated.getId(),</span>
<span class="fc" id="L210">				Boolean.class);</span>
<span class="fc" id="L211">		assertEquals(requestAccept.getStatusCode(),HttpStatus.OK);</span>
<span class="fc" id="L212">		assertEquals(requestAccept.getBody(),true);</span>
<span class="fc" id="L213">		ResponseEntity&lt;String&gt; requestActive=this.restTemplate.getForEntity(&quot;http://localhost:&quot; + port + &quot;/api/admins/requests?active=1&quot;,</span>
<span class="fc" id="L214">				String.class);</span>
<span class="fc" id="L215">		arr=new JSONArray(requestActive.getBody());</span>
<span class="fc" id="L216">		finded=false;</span>
<span class="pc bpc" id="L217" title="1 of 4 branches missed.">		for(int i=0;i&lt;arr.length() &amp;&amp; finded==false;i++) {</span>
<span class="fc bfc" id="L218" title="All 2 branches covered.">			if(arr.getJSONObject(i).getString(&quot;id&quot;).contentEquals(managerCreated.getId())) finded=true;</span>
		}
<span class="fc" id="L220">		assertEquals(finded,true);</span>
		
<span class="fc" id="L222">		String reqDel=&quot;http://localhost:&quot; + port + &quot;/api/managers/&quot;+managerCreated.getId();</span>
<span class="fc" id="L223">		restTemplate.delete(reqDel);</span>
<span class="fc" id="L224">	}</span>
	
	@Test
	public void getAdminRemove() throws Exception {
<span class="fc" id="L228">		AddManagerRequest request=new AddManagerRequest();</span>
<span class="fc" id="L229">		request.name=&quot;utenteNomeProva&quot;;</span>
<span class="fc" id="L230">		request.surname=&quot;utenteCognomeProva&quot;;</span>
<span class="fc" id="L231">		request.mail=&quot;prova@gmail.com&quot;;</span>
<span class="fc" id="L232">		request.password=&quot;provaUser&quot;;</span>
<span class="fc" id="L233">		request.dateOfBirth=LocalDate.now().minusYears(30);</span>
<span class="fc" id="L234">		request.residence=new Location();</span>
<span class="fc" id="L235">				request.residence.setLocality(&quot;prova via&quot;);</span>
<span class="fc" id="L236">				request.residence.setCap(&quot;24042&quot;);</span>
<span class="fc" id="L237">				request.residence.setRegione(&quot;Lombardia&quot;);</span>
<span class="fc" id="L238">				request.residence.setProvincia(&quot;Bergamo&quot;);</span>
<span class="fc" id="L239">				request.residence.setCity(&quot;Albino&quot;);</span>
<span class="fc" id="L240">				request.residence.setLat(44d);</span>
<span class="fc" id="L241">				request.residence.setLng(9d);</span>
<span class="fc" id="L242">				request.residence.setSigla(&quot;BG&quot;);</span>
<span class="fc" id="L243">		request.codicePIVA=&quot;77914680192&quot;;</span>
<span class="fc" id="L244">		request.ragioneSociale=&quot;prova s.r.l.&quot;;</span>
<span class="fc" id="L245">		ManagerResponse managerCreated = restTemplate.postForObject(&quot;http://localhost:&quot; + port + &quot;/api/managers&quot;, request, ManagerResponse.class);</span>
<span class="fc" id="L246">		ResponseEntity&lt;String&gt; requestNonActive=this.restTemplate.getForEntity(&quot;http://localhost:&quot; + port + &quot;/api/admins/requests&quot;,</span>
<span class="fc" id="L247">				String.class);</span>
<span class="fc" id="L248">		JSONArray arr=new JSONArray(requestNonActive.getBody());</span>
<span class="fc" id="L249">		Boolean finded=false;</span>
		
<span class="pc bpc" id="L251" title="1 of 4 branches missed.">		for(int i=0;i&lt;arr.length() &amp;&amp; finded==false;i++) {</span>
<span class="pc bpc" id="L252" title="1 of 2 branches missed.">			if(arr.getJSONObject(i).getString(&quot;id&quot;).contentEquals(managerCreated.getId())) finded=true;</span>
		}
<span class="fc" id="L254">		assertEquals(finded,true);</span>
<span class="fc" id="L255">		ResponseEntity&lt;Boolean&gt; requestRemove=this.restTemplate.exchange(&quot;http://localhost:&quot; + port + &quot;/api/admins/remove/&quot;+managerCreated.getId(), HttpMethod.DELETE, null, Boolean.class);</span>
<span class="fc" id="L256">		assertEquals(requestRemove.getStatusCode(),HttpStatus.OK);</span>
<span class="fc" id="L257">		assertEquals(requestRemove.getBody(),true);</span>
<span class="fc" id="L258">		ResponseEntity&lt;String&gt; requestManager=this.restTemplate.getForEntity(&quot;http://localhost:&quot; + port + &quot;/api/managers/&quot;+managerCreated.getId(),</span>
<span class="fc" id="L259">				String.class);</span>
<span class="fc" id="L260">		int statusCode=requestManager.getStatusCodeValue();</span>
<span class="fc" id="L261">		assertEquals(statusCode,404);</span>
<span class="fc" id="L262">	}</span>
	
	@Test
	public void getAdminRemoveError() throws Exception {
<span class="fc" id="L266">		ResponseEntity&lt;Boolean&gt; requestRemove=this.restTemplate.exchange(&quot;http://localhost:&quot; + port + &quot;/api/admins/remove/61a0a0eeb5f9b12d06e95235&quot;, HttpMethod.DELETE, null, Boolean.class);</span>
<span class="fc" id="L267">		assertEquals(requestRemove.getStatusCode(),HttpStatus.NOT_FOUND);</span>
<span class="fc" id="L268">	}</span>
	
	@Test
	public void getAdminMalus() throws Exception {
<span class="fc" id="L272">		AddManagerRequest request=new AddManagerRequest();</span>
<span class="fc" id="L273">		request.name=&quot;utenteNomeProva&quot;;</span>
<span class="fc" id="L274">		request.surname=&quot;utenteCognomeProva&quot;;</span>
<span class="fc" id="L275">		request.mail=&quot;prova@gmail.com&quot;;</span>
<span class="fc" id="L276">		request.password=&quot;provaUser&quot;;</span>
<span class="fc" id="L277">		request.dateOfBirth=LocalDate.now().minusYears(30);</span>
<span class="fc" id="L278">		request.residence=new Location();</span>
<span class="fc" id="L279">				request.residence.setLocality(&quot;prova via&quot;);</span>
<span class="fc" id="L280">				request.residence.setCap(&quot;24042&quot;);</span>
<span class="fc" id="L281">				request.residence.setRegione(&quot;Lombardia&quot;);</span>
<span class="fc" id="L282">				request.residence.setProvincia(&quot;Bergamo&quot;);</span>
<span class="fc" id="L283">				request.residence.setCity(&quot;Albino&quot;);</span>
<span class="fc" id="L284">				request.residence.setLat(44d);</span>
<span class="fc" id="L285">				request.residence.setLng(9d);</span>
<span class="fc" id="L286">				request.residence.setSigla(&quot;BG&quot;);</span>
<span class="fc" id="L287">		request.codicePIVA=&quot;77914680192&quot;;</span>
<span class="fc" id="L288">		request.ragioneSociale=&quot;prova s.r.l.&quot;;</span>
<span class="fc" id="L289">		ManagerResponse managerCreated = restTemplate.postForObject(&quot;http://localhost:&quot; + port + &quot;/api/managers&quot;, request, ManagerResponse.class);</span>
<span class="fc" id="L290">		this.restTemplate.getForEntity(&quot;http://localhost:&quot; + port + &quot;/api/admins/accept/&quot;+managerCreated.getId(),</span>
<span class="fc" id="L291">				Boolean.class);</span>
<span class="fc" id="L292">		ResponseEntity&lt;Boolean&gt; requestMalus=this.restTemplate.getForEntity(&quot;http://localhost:&quot; + port + &quot;/api//admins/malus=&quot;+managerCreated.getId(),</span>
<span class="fc" id="L293">				Boolean.class);</span>
<span class="fc" id="L294">		assertEquals(requestMalus.getStatusCode(),HttpStatus.OK);</span>
<span class="fc" id="L295">		assertEquals(requestMalus.getBody(),true);</span>
		
<span class="fc" id="L297">		ResponseEntity&lt;String&gt; requestActive=this.restTemplate.getForEntity(&quot;http://localhost:&quot; + port + &quot;/api/admins/requests?active=1&quot;,</span>
<span class="fc" id="L298">				String.class);</span>
<span class="fc" id="L299">		JSONArray arr=new JSONArray(requestActive.getBody());</span>
<span class="fc" id="L300">		int finded=-1;</span>
<span class="pc bpc" id="L301" title="1 of 4 branches missed.">		for(int i=0;i&lt;arr.length() &amp;&amp; finded==-1;i++) {</span>
<span class="pc bpc" id="L302" title="1 of 2 branches missed.">			if(arr.getJSONObject(i).getString(&quot;id&quot;).contentEquals(managerCreated.getId())) finded=i;</span>
		}
<span class="fc" id="L304">		String dt=arr.getJSONObject(finded).getString(&quot;dateRenewal&quot;);</span>
<span class="fc" id="L305">		String day=dt.substring(0, dt.indexOf(&quot;T&quot;));</span>
<span class="fc" id="L306">		SimpleDateFormat formatter = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);</span>
<span class="fc" id="L307">		assertTrue(formatter.parse(day).before(Functionalities.convertToDate(LocalDate.now().minusYears(1))));</span>
		
<span class="fc" id="L309">		String reqDel=&quot;http://localhost:&quot; + port + &quot;/api/managers/&quot;+managerCreated.getId();</span>
<span class="fc" id="L310">		restTemplate.delete(reqDel);</span>
<span class="fc" id="L311">	}</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span>com.scarcolo.eventour (30 dic 2021 11:11:30)</div></body></html>